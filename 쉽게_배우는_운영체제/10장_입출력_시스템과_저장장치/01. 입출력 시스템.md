# 01. 입출력 시스템

### 1. 입출력 장치와 채널

컴퓨터의 구성요소는 CPU, 메모리, 입출력장치, 저장장치 등으로 구성된다.

각 장치는 데이터 전송 속도에 따라 저속 주변장치와 고속 주변장치로 나뉜다..

`저속 주변장치`

- 메모리와 주변장치 사이 오고 가는 데이터양이 적어 데이터 전송률이 낮은 장치를 의미 한다.
- 키보드의 경우 아무리 빠르게 타이핑을 해도, 초당 전송률이 1KB를 넘지 않기에 저속 주변장치로 분류된다.

`고속 주변장치`

- 메모리와 주변 장치 사이에 대용량의 데이터가 오고 가기 때문에, 데이터 전송률이 높은 장치를 말한다.
- 출력장치인 그래픽 카드의 경우 모니터에 초당 수십 장의 그래픽을 보여주어야 하기에, 고속 주변장치에 해당한다. 하드디스크 또한, 메모리와의 상호작용에서 대용량 데이터를 주고 받기에 고속 주변장치로 분류된다.

`채널`

- 데이터가 지나다니는 하나의 통로
- ex) 4채널 버스는 4개의 주변장치가 동시에 데이터를 주고 받을 수 있는 통로를 의미
- 주의점
  - 주변장치 별 속도가 다르기에, 무분별하게 채널을 공유하면, 효율이 안 좋을 가능성이 높다.

→ 전송 속도가 비슷한 장치끼리 묶어 채널을 할당 한다면, 여러 채널을 효율적으로 사용하여 전체 데이터 전송 속도를 높일 수 있다.

### 2. 입출력 버스의 구조

`초기의 구조`

컴퓨터 사용 초기에는 주변 장치가 많지 않아, 장치들이 하나의 버스로 연결되었다.

`폴링`

- CPU가 작업을 진행하다 입출력 명령을 만날 때, 입출력장치에서 데이터를 가져옴.
- 특징
  - CPU나 메모리보다 주변장치의 속도가 느리기 때문에, CPU가 직접 입출력을 처리할 경우, 입출력이 완료될 때까지, 다른 작업을 진행할 수 없다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/97b0a30a-7067-4d35-bb63-7f2fabc35aa6/3402558e-0ee9-4575-9696-6ffe4e9ec8bf/Untitled.png)

`입출력 제어기를 사용한 구조`

- 배경
  - CPU와 메모리의 성능 향상과 더불어, 주변 장치의 종류가 많아져 폴링 방식으로 주변 장치를 관리하기는 힘들다.
  - 모든 입출력을 입출력 제어기에 맡기는 형식으로 전환
- 입출력 제어기
  - 특징
    - 메인 버스와 입출력 버스를 따로 둔다.
    - 입출력 버스를 통해 입출력 제어기에 신호가 올 때, 메인 버스로 CPU나 메모리에 데이터를 보내는 형식이다.
    - CPU, 메모리와 주변 장치간의 속도 차이만 고려하였고, 주변 장치끼리의 속도 차이는 고려하지 않은 방식

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/97b0a30a-7067-4d35-bb63-7f2fabc35aa6/6b8494c8-9679-4351-9cdb-6c1516e77cce/Untitled.png)

`입출력 버스의 분리`

- 배경
  - 고속 주변장치와 저속 주변장치의 데이터 전송 속도 차이로 발생하는 병목현상을 줄이기 위해 나타남
- 특징
  - 고속 입출력 버스와 저속 입출력 버스를 분리하여 운영한다.
  - 채널 선택기
    - 고속 입출력과 저속 입출력 사이의 데이터 전송을 관리한다.
  - AGP
    - 그래픽 카드의 고성능화에 따라, 그래픽 카드를 분리하여, 메인 버스에 바로 연결시키는 형식으로 발전함.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/97b0a30a-7067-4d35-bb63-7f2fabc35aa6/768f0903-7802-40f5-97f8-1fd164ce7e4b/Untitled.png)

---

### 3. 직접 메모리 접근

- 일반적으로, 메모리는 CPU의 명령을 통해 접근할 수 있지만, 입출력 제어기는 메모리에 직접 접근할 수 있는 DMA 제어기를 갖고 있다.
- DMA 제어기는 메모리와 입출력 장치 채널 간의 상호 작용을 할 수 있게 해준다.
- 메모리 맵 입출력(MMIO)
  - 배경
    - CPU와 DMA 제어기 모두 메모리를 사용하기 때문에, 충돌 가능성이 존재 한다.
  - 정의
    - 충돌 방지를 위해, 메모리에 일부를 DMA 제어기에 할당함으로써, 겹치지 않게 처리 하는 것

### 4. 인터럽트

`입출력과 인터럽트`

- 인터럽트
  - 입출력이 완료되거나, 하드웨어 이상 현상을 알려주는 것
- IRQ
  - 인터럽트의 원인은 다양하기에, 인터럽트가 발생한 장치에 IRQ라는 번호가 부여된다.
  - 이를 통해, 어느 장치에 인터럽트가 발생했는지 파악한다.

`인터럽트 벡터와 인터럽트 핸들러`

- 인터럽트 벡터
  - 어떤 종류의 인터럽트가 발생했는지 알기 위한 벡터
  - 벡터 인덱스가 1이면 해당 인터럽트가 발생했다는 의미
  - 각 인터럽트마다 인터럽트 핸들러와 연결되어 있고, 인터럽트 핸들러는 해당 인터럽트가 발생했을 때의 처리 방법을 함수로 만들어 놓은 것이다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/97b0a30a-7067-4d35-bb63-7f2fabc35aa6/f85c7019-79eb-4473-bd4b-149e28c87a66/Untitled.png)

### 5. 단일 버퍼와 이중 버퍼

`버퍼`

- 속도가 다른 장치의 속도 차이를 완화

`단일 버퍼 vs 이중 버퍼`

단일 버퍼

- 데이터를 버퍼에 담는 작업과 버퍼에 있는 데이터를 퍼가는 작업을 동시에 하기 어려움

이중 버퍼

- 두 개의 버퍼가 각각 데이터를 담고, 퍼가는 작업을 하면서 동시에 처리 가능
