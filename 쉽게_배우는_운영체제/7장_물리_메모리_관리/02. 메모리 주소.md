# 02. 메모리 주소

메모리에 접근할 때는 주소를 이용한다.

메모리 주소는 물리 주소와 논리 주소로 나뉘고, 두 주소의 차이를 알아야 한다.

### 1. 32bit CPU와 64bit CPU의 차이

CPU에서 말하는 bit는 CPU가 한 번에 다룰 수 있는 데이터의 최대 크기를 의미한다.

32bit CPU 기준으로, 레지스터 크기, 산술논리 연산장치, 데이터를 전송하는 버스들의 크기, 대역폭 등도 32bit다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/97b0a30a-7067-4d35-bb63-7f2fabc35aa6/43f9e7d4-0131-48b8-b861-e601b77e2029/Untitled.png)

- CPU의 비트는 메모리 주소 공간의 크기와도 연관이 있다.
- 32bit CPU의 경우 표현할 수 있는 메모리 주소의 범위는 0 ~ 2^32 -1 이다. 이는 약 4GB가 나온다.

→ 32bit CPU는 메모리를 최대 4GB까지 사용할 수 있다.

### 2. 논리 주소와 물리 주소

`메모리 영역의 구분`

사용자가 침범하지 못하는 영역인 운영체제 영역과 일반적인 응용프로그램이 돌아가는 사용자 영역으로 나뉜다.

- 운영체제가 할당 받은 메모리 영역을 우선 할당하고, 이 후에 빈 부분을 사용자 영역의 메모리를 채워 넣는다.
- 경계 레지스터
  - 사용자 영역의 메모리가 운영체제 영역의 메모리를 침범하지 않게 하기 위한 CPU 레지스터
  - 메모리 관리자는 사용자가 작업을 요청할 때마다, 운영체제 영역을 침범하는 지 경계 레지스터 영역을 통해 확인한다.
  - 경계 레지스터의 값을 벗어나게 되면 해당 프로세스를 종료한다.

`논리 주소와 물리 주소의 변환`

**물리 주소**

- 물리 주소는 실제로 메모리에 올라오는 주소를 의미한다.

**논리 주소**

- 논리 주소는 프로세스 입장에서의 주소를 의미한다.

```jsx
char alp = 'A'
```

앞의 alp라는 변수가 40번지에 A를 저장하는 코드로 컴파일이 되었다고 했을 때, 실제 메모리의 40번지에 저장되는 것이 아닌 400번지 등 실제 메모리에는 다른 주소에 저장된다.

이 때, 논리 주소를 40번지, 물리 주소를 400번지라고 생각하면 된다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/97b0a30a-7067-4d35-bb63-7f2fabc35aa6/50a52dca-fe8d-4d60-8176-735021f2adc3/Untitled.png)

→ 프로세스의 메모리 할당은 유동적으로 이루어지기 때문에, 이처럼 프로세스가 인지하는 주소와 실제 저장되는 메모리 주소의 차이가 발생한다.

→ 그렇기에, 프로세스 입장에서 논리 주소를 실제 물리 주소로 변환하는 작업이 필요하다.

`메모리 관리 유닛(MMU: Memory Management Unit)`

- 정의
  - CPU에 존재하는 프로세스가 논리 주소에 접근할 때 마다 이를 물리 주소로 변환하는 작업을 한다.
- 논리 주소를 물리 주소로 변환하는 과정
1. 사용자 프로세스가 논리 주소 40에 있는 데이터를 요청한다.
2. CPU는 메모리 관리 유닛에 40번지에 있는 내용을 가져오라고 명령한다.
3. 메모리 관리 유닛은 재배치 레지스터를 사용하여 메모리 400번지에 저장된 데이터를 가져온다.

운영체제 영역의 범위가 지속적으로 변하기 때문에, 재배치 레지스터가 사용자 영역의 시작점을 가짐으로써, 논리 주소를 물리주소로 지속적으로 변환시켜주는 역할을 해준다.
