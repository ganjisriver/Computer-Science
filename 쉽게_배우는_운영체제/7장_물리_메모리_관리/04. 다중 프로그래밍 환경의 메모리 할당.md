# 04. 다중 프로그래밍 환경의 메모리 할당

### 1. 메모리 분할 방식

메모리에 여러 개의 프로세스를 배치하는 방법은 가변 분할 방식과 고정 분할 방식으로 나뉜다.

`가변 분할 방식`

- 정의
  - 프로세스의 크기에 맞춰 메모리를 분할하여 할당하는 방식
- 특징
  - 한 프로세스가 메모리의 연속된 공간에 배치되기 때문에, 연속 메모리 할당이라고 한다.
  - 물리 메모리 상에서 하나의 프로세스에 해당하는 주소 공간이 연속적으로 이어지기 때문이다.
- 장점
  - 프로세스를 연속된 메모리에 할당할 수 있다는 장점이 있다.
- 단점
  - 메모리 관리가 복잡하다.
    - 메모리 할당이 가변형식이라, 종료되는 프로세스 다음으로 들어오는 프로세스와의 크기 차이로 메모리 차이가 발생할 수 있다는 문제가 있다.

`고정 분할 방식의 구현`

- 정의
  
  - 프로세스의 크기에 상관없이 20KB의 같은 크기에 할당하는 것이다.
  
  → 프로세스의 크기가 20KB보다 크게 되면, 프로세스도 분할되어 메모리에 배치되게 된다.

- 특징
  
  - 고정 분할 방식에서는 하나의 프로세스가 여러 개로 나뉘기 때문에, 비연속 메모리 할당이라고 한다.

- 장점
  
  - 메모리 관리가 편하다.
  - 메모리 통합 등의 부가적인 작업을 할 필요가 없다.

- 단점
  
  - 하나의 프로세스가 여러 곳으로 나뉠 수 있다는 점이다.

메모리 관리는 기본적으로 고정 분할 방식을 사용한다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/97b0a30a-7067-4d35-bb63-7f2fabc35aa6/631e3e6f-3776-42b3-bf2e-849e5ba7ed29/Untitled.png)

### 2. 가변 분할 방식의 메모리 관리

`가변 분할 방식의 특징`

- 세그먼테이션
  - 프로세스의 크기에 맞게 메모리를 할당하는 방식을 의미
- 외부 단편화
  - 정의
    - 가변 분할 방식에서 발생하는 빈 공간을 의미 한다.
  - 원인
    - 메모리 자리를 반환한 프로세스의 크기보다 들어오는 프로세스의 메모리의 크기가 더 클 때, 해당 프로세스는 들어올 수 없다, 이 때 발생하는 메모리의 빈 공간이 외부 단편화라고 한다.
  - 해결 방법
    - 메모리 배치 방식
      - 작은 조각이 발생하지 않도록 프로세스를 배치
      - 선 처리 방식
    - 조각 모음
      - 조각을 모아 하나의 큰 덩어리로 만드는 작업이다.
      - 후 처리 방식

`메모리 배치 방식`

가변 분할 방식의 외부 단편화 문제를 해결하기 위한 대표적 방식

- 최초 배치
  - 단편화를 고려하지 않는 방식
  - 프로세스를 빈 공간에 배치할 때, 메모리에서 적재 가능한 공간을 순서대로 찾다가 첫 번째로 발견한 공간에 프로세스를 배치한다.
- 최적 배치
  - 메모리의 빈 공간을 모두 확인 하고, 크기가 가장 비슷한 곳에 프로세스를 배치하는 방법
- 최악 배치
  - 빈 공간을 모두 확인한 후 가장 큰 공간에 프로세스를 배치하는 것
  - 최적 배치와 정 반대의 방법이다.

`조각 모음`

단편화가 발생할 때, 발생한 조각을 모아 빈 공간을 합치는 개념

- 조각 모음 동작 방식
  1. 조각 모음을 하기 위해 이동할 프로세스의 동작을 멈춘다.
  2. 프로세스를 적당한 위치로 이동한다.
  3. 프로세스가 원래의 위치에서 이동하기 때문에, 프로세스의 논리 주소 값을 바꾼다.
  4. 위의 작업을 마친 후 프로세스를 재 실행한다.

위와 같은 방식을 해야하기 때문에, 메모리 관리가 비교적 복잡하다.

### 3. 고정 분할 방식의 메모리 관리

`페이징`

- 고정 분할 방식을 이용하여 물리 메모리를 나누는 방식
- 현대의 메모리 관리 기법으로 사용함

`내부 단편화`

- 고정 분할 방식에서 20KB의 메모리를 모듈당 할당을 한다.
- 특정 모듈이 20KB 미만이게 되면, 남는 메모리 영역이 존재하는데, 이를 내부 단편화라고 함.

### 4. 버디 시스템

`버디 시스템의 작동 방식`

- 가변 분할 방식의 단점인 외부 단편화를 완화하는 방식
- 고정 분할 방식과 가변 분할 방식의 중간 방식
1. 프로세스의 크기에 맞게 메모리를 1/2로 나누어 메모리에 배치한다.
2. 나뉜 메모리의 각 구역에는 프로세스가 1개만 들어간다.
3. 프로세스가 종료되면 주변의 빈 조각과 합쳐 하나의 큰 덩어리를 만든다.

`버디 시스템의 특징`

- 고정 분할 방식의 특징
  - 하나의 구역에 다른 프로세스가 들어갈 수 없다.
  - 메모리의 빈 구역에 조각이 발생하여 내부 단편화가 발생한다.
- 가변 분할 방식의 특징
  - 메모리가 프로세스의 크기로 나뉜다.

→ 효율성은 고정 분할 방식과 비슷하고, 동작 방식은 고정 분할 방식이 더 간단하기 때문에, 고정 분할 방식을 현대 시스템에서는 많이 사용한다.
