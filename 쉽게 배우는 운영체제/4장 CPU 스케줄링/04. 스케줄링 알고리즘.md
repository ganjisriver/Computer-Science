# 04. 스케줄링 알고리즘

1. **스케줄링 알고리즘의 선택 기준**
- `CPU 사용률`
  - 전체 시스템의 동작 시간 중 CPU가 사용된 시간을 측정하는 방법
  - 가장 이상적인 수치는 100%이나, 실질적으로 90%미만으로 유지 된다.
- `처리량`
  - 처리량은 단위 시간당 작업을 마친 프로세스의 수로 이 수가 높아야 좋은 알고리즘이다.
- `대기 시간`
  - 작업을 요청했을 때, 프로세스가 작업을 시작하기 전까지 기다리는 시간
  - 낮을수록 시스템 효율이 좋다.
- `응답 시간`
  - 프로세스 시작 후 첫 번째 출력 또는 반응이 나올 때까지 걸리는 시간
- `반환 시간`
  - 프로세스가 생성된 후 종료되어 사용한 자원을 반환하는 데 걸리는 시간.

→ 일반적으로 처리량은 계산하기가 어려워 나머지 4가지를 기준으로 계산함.

![Untitled](./assets/4-4-1%20스케줄링%20알고리즘.png)

1. **FCFS 스케줄링**

`동작 방식`

- 정의
  - 준비 큐에 도착한 순서대로 CPU를 할당하는 비선점형 방식으로, FIFO 스케줄링이라고도 함.
- 특징
  - 초기 일괄 작업 시스템에서 사용되던 스케줄링 방식으로, 한 번 실행한 프로세스가 끝나야, 다음 프로세스가 진행할 수 있고, 큐도 하나라 우선순위도 동일하다.

`성능`

| 도착 순서 | 도착 시간 | 작업 시간 |
| ----- | ----- | ----- |
| P1    | 0     | 30    |
| P2    | 3     | 18    |
| P3    | 6     | 9     |

FCFS 스케줄링을 기반으로 각 프로세스의 대기 시간을 고려해 볼 때, P1은 0, P2는 27, P3는 42로 평균 대기시간은 23이 나온다.

`평가`

- 단순하고, 공평하지만 처리 시간이 긴 프로세스가 CPU를 지속적으로 점유할 수 있다.
  
  - 대기 시간이 길어지는 비효율이 발생한다.
  - 입출력 작업이 필요한 프로세스가 오면, 작업을 하지 않은 채, 지속적으로 대기해야 한다.
1. **SJF 스케줄링**

`동작 방식`

- 정의
  - 준비 큐에 있는 프로세스 중 실행 시간이 가장 짧은 작업부터 CPU를 할당 하는 비선점형 방식, 최단 작업 우선 스케줄링이라고도 함
- 특징
  - 프로세스에 CPU를 배정할 때, 시간이 오래 걸리는 작업이 앞에 있으면, 간단한 작업을 앞으로 놓아 실행 한다.

`성능`

| 도착 순서 | 도착 시간 | 작업 시간 |
| ----- | ----- | ----- |
| P1    | 0     | 30    |
| P2    | 3     | 18    |
| P3    | 6     | 9     |

FCFS 스케줄링 방식에서 사용한 프로세스를 볼 때, 각각의 작업의 대기시간을 살펴 보면, P1은 0, P3가 P2보다 작업 시간이 짧아, P3는 24초, P2는 36초 걸려 평균 대기 시간은 FCFS 스케줄링 방식보다 3초 짧은 20초다.

`평가`

1. 운영체제가 프로세스의 종료 시간을 정확하게 예측하기 힘들다.
- 입출력이 필요한 프로세스의 경우, 그 입출력 시간을 정확히 예측할 수 없기에, 프로세스의 작업 시간을 정확히 예측할 수 없어 적용하기 힘들다.
1. 공평성에 위배된다.
- 해당 방식은 작업 시간이 긴 프로세스가 작업을 계속 못하게 되는 경우가 생기는데, 이를 아사 현상, 무한 봉쇄 현상이라고 한다.

`해결법`

- 에이징
  - 프로세스가 양보하는 상한선을 정하여 해결 가능
  - 이 마저도, 에이징을 어떤 기준으로 정할 지의 한계가 있다.

→ 위 두 가지 문제로 잘 사용하지 않음.

1. **HRN 스케줄링**

SJF 스케줄링의 아사 현상을 방지하기 위해 나타난 비선점형 알고리즘

`동작 방식`

- 특징
  - 기본적으로, 프로세스 작업 시간이 짧은 프로세스에 높은 우선 순위가 부여된다.
  - 하지만, 대기 시간과 CPU 사용 시간을 고려하여 스케줄링 하는 방식이다.

HRN 스케줄링 방식에서 정의한 우선순위 방식

$우선순위\,=\,\frac{대기\,시간\,+\,CPU\,사용\,시간}{CPU\,사용\,시간}$

`성능`

- 대기 시간을 고려함으로써, SJF 스케줄링에서 나타나는 아사 현상을 완화한다.

`평가`

- SJF 스케줄링과 비교하면 대기시간이 긴 프로세스의 우선 순위를 높였다.

- 하지만, 여전히 공평성에 위배되는 스케줄링 방식이다.
1. **라운드 로빈 스케줄링**

`동작 방식`

- 정의
  - 프로세스가 할당 받은 시간(타임 슬라이스) 동안 완료하지 못하면, 준비 큐의 맨 뒤로 가는 선점형 알고리즘 중 가장 간단한 방식
- 특징
  - FCFS 방식처럼, 먼저 들어오는 프로세스 먼저 실행이 되지만, 타임 슬라이스가 존재하여 병목 현상이 완화된다.
  - 우선순위가 적용 되지 않은 가장 단순한 선점형 스케줄링 방식

`성능`

- 앞서 살펴 본 표에서의 FCFS는 평균 대기시간이 23초인데 반해, 라운드 로빈 스케줄링은 22.33초로, 큰 차이가 나지 않지만, 앞선 프로세스를 기다리는 콘보이 효과가 줄어든다.

`평가`

- 상황에 따라, FCFS 스케줄링방식보다 평균 대기 시간이 오래 걸릴 수 있다.

- 평균적인 작업 시간이 긴 프로세스들이 있다면, 효율이 더 안나올 것이다.
1. **SRT 우선 스케줄링**

`동작 방식`

- 특징
  - SJF 스케줄링과 라운드 로빈 스케줄링 방식을 혼합함
  - SJF 스케줄링의 선점형 방식이라 볼 수 있고, 타임 슬라이스가 있고, 잔여 시간이 적게 남은 프로세스부터 할당한다.

`성능`

- 동일한 예시의 프로세스 대기상태가 있다면 P1(0) + P2(4) + P3(16) + P1(27)초로 평균은 15.66초가 나온다.

`평가`

- 사용하지 않는 이유(SJF 스케줄링의 단점과 동일)
  - 아사 현상의 발생 가능성
  - 프로세스 종료 시간 측정의 어려움
1. **우선순위 스케줄링**
- 정의
  - 프로세스 별 우선순위를 정하여 구현한다. 어떤 우선순위 방식을 적용함에 따라 성능이 달라짐
- 성능도 우선순위에 따라 달라지기에 언급 불가

앞서 언급한 고정 우선순위 방식, 변동 우선순위 방식이 존재한다.

`평가`

- 마찬가지로, 우선순위에 따른 아사 현상 발생가능성 존재
- 프로세스의 우선 순위를 지속적으로 바꾸기 때문에, 오버헤드로 인한 시스템 효율 저하
1. **다단계 큐 스케줄링**
- 정의
  - 우선순위에 따라 준비 큐를 여러개 사용하는 방식
- 특징
  - 라운드 로빈 방식으로 운영되는 큐는 우선순위에 따라 다단계로 나뉘어 있다.
  - 우선 순위는 고정형 우선순위를 사용하여 상단 큐의 프로세스가 모두 끝나야 다음 큐가 실행된다.
- 예시
  - 전면 프로세스에 적용하는 우선순위
    - 반응 속도를 높이기 위해 타임 슬라이스를 작게함
  - 후면 프로세스에 적용하는 우선순위
    - 사용자와 상호작용이 없어 FCFS 방식으로 처리
- 단점
  - 마찬가지로, 상위 큐의 작업이 끝나야 하위 큐의 작업이 실행가능하기에, 우선순위가 낮은 프로세스는 작업이 연기된다.

→ 이 문제를 해결하기 위한 다단계 피드백 큐 스케줄링이 등장

1. **다단계 피드백 큐 스케줄링**

앞서 언급한 다단계 큐 스케줄링의 문제를 보완한 방식

- 특징
  
  - 다단계 큐 스케줄링과 마찬가지로, 우선순위를 가진 여러 개의 큐를 가짐
  
  → 다단계 큐 스케줄링과 동일
  
  - CPU를 사용한 후의 프로세스의 우선순위가 낮아진다.
  - 우선 순위에 따라 타임 슬라이스가 다름
  
  → 다단계 큐 스케줄링과 다른 점
  
  - 현대의 운영체제의 CPU 스케줄링 방식
  - 낮은 우선순위를 가진 프로세스는 더 높은 타임 슬라이스를 가짐
  - 가장 우선순위가 낮은 큐에 배치된 프로세스는 무한 타임 슬라이스를 가짐.
